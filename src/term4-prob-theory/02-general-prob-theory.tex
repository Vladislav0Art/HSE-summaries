\Subsection{Колмогоровская модель теории вероятности}

\begin{definition}
    $(\Omega, \mathcal{F}, P)$ - вероятностное пространство.

    $\Omega$ - множество или пространство элементарных исходов.

    $\mathcal{F}$ - $\sigma$-алгебра подмножеств $\Omega$. Элементы $\mathcal{F}$ - случайный события.

    $P$ - мера на $\mathcal{F}$ с условием $P(\Omega) = 1$.

    \begin{remark}
        Если $\Omega$ не более чем счётно, то можно взять $\mathcal{F} = 2^{\Omega}$
    \end{remark}
\end{definition}

\begin{definition}
    Условная вероятность. $A$ - событие, такое, что $P(A) > 0$.
    Тогда $P(B | A) = \frac{P(B \cap A)}{P(A)}$, где $A, B \in \mathcal{F}$.
\end{definition}

\begin{definition}
    Независимые события $A$ и $B$. Если $P(A \cap B) = P(A) \cdot P(B)$
\end{definition}

\begin{definition}
    Независимость в совокупности $A_1, A_2 \ldots A_n$. $P(A_{i_1} \cap \ldots \cap A_{i_k}) = P(A_{i_1}) \cdot \ldots \cdot P({A_{i_k}})$
    для всевозможных наборов индексов.
\end{definition}

\begin{definition}
    Последовательность событий $A_1, A_2 \ldots $ независимы - любой конечный набор событий
    независим в совокупности.
\end{definition}

\begin{lemma}
    \textbf{Бореля-Кантелли}

    $A_1, A_2, \ldots$ случайные события.

    \begin{enumerate}
        \item {
            Если $\sum_{n = 1}^{\infty} P(A_n) < +\infty$, то вероятность, что случилось бесконечное число из них равна 0.
        }
        \item {
            Если $A_1, A_2, \ldots$ независимы и $\sum_{n = 1}^{\infty} P(A_n) = +\infty$, тогда
            
            $P(\text{случилось бесконечное число из $A_n$}) = 1$.
        }
    \end{enumerate}
\end{lemma}

\begin{proof}
    $B = \bigcap_{n = 1}^{\infty} \bigcup_{k = n}^{\infty} A_k$.

    $\omega \in B \Longleftrightarrow \omega \in \bigcup_{k = n}^{\infty} A_k \ \forall n \Longleftrightarrow w \in A_k$ для бесконечного количества индексов $k$.

    Док-во этого факта:

    \begin{enumerate}
        \item $\Leftarrow:$ Лежит в каждом объединении, значит лежит в $B$.
        \item $\Rightarrow:$ $\omega$ лежит в пересечении. Пусть лежит в конечном - возьмём самый большой номер и получим противоречие.
    \end{enumerate}

    Док-во теоремы:

    \begin{enumerate}
        \item $P(B) = 0$ - хотим доказать.
        
        $B \subset \bigcup_{k = n}^{\infty} A_k \Rightarrow P(B) \leqslant P(\bigcup_{k = n}^{\infty} A_k) \leqslant \sum_{k = n}^{\infty} P(A_k)$, 
        а это хвост сходящегося ряда, а он стремится к нулю.

        \item Давайте смотреть на $\bar{A_1}, \bar{A_2}, \ldots$ - независимые события (следует из упражнения с прошлой лекции).
        
        $P(\bigcap_{k = 1}^n \bar{A_k}) = \prod_{k = 1}^{n} P(\bar{A_k}) \to_{n \to \infty} \prod_{k = 1}^{\infty}  P(\bar{A_k})$

        Но всё вложено по убыванию, по монотонности меры получаем $P(\bigcap_{k = 1}^{\infty} \bar{A_k}) = \prod_{k = 1}^{\infty} P(\bar{A_k}) = 
        \prod_{k=1}^{\infty} (1 - P(A_k))$

        Прологарифмируем это равенство.

        % $\ln (P(\bigcap_{n}^{\infty} \bar{A_k})) = \sum{k = n}^{\infty} \ln (1 - P(A_k)) \leqslant - \sum{k = n}^{\infty} P(A_k) = -\infty$ - сумма
        % хвоста расходящегося ряда.

        $\ln (P(\bigcap_{k = n}^{\infty} \bar{A}_k)) = \sum_{k = n}^{\infty} \ln(1 - P(A_k)) \leqslant \sum_{k = n}^{\infty} (-P(A_k)) = -\infty$ -- сумма хвоста расходящегося ряда.

        А значит мы логарифмировали $0 \Rightarrow P(\bigcap_{k = n}^{\infty} \bar{A_k}) = 0 \Rightarrow P(\bigcup_{n=1}^{\infty} \bigcap_{k = n}^{\infty} \bar{A}_k) = 0 \Rightarrow P(\bar{B}) = 0 \Rightarrow$
        
        $\Rightarrow \overline{\bigcup_{n=1}^{\infty} \bigcap_{k = n}^{\infty} \bar{A}_k} = \bigcap_{n=1}^{\infty} \bigcup_{k=n}^{\infty} A_k = B \Rightarrow P(B) = 1$.

        Добавим, что $B = \bigcap_{n = 1}^{\infty} B_n$, где $B_1 \supset B_2 \supset \ldots$ и $P(B) = \lim P(B_n) = 1$.
    \end{enumerate}
\end{proof}

\begin{theorem}
    \textbf{Закон нуля и единицы}

    Если $A_1, A_2 \ldots$ независимы, то $P(B) = 0$ или $P(B) = 1$.
\end{theorem}

\begin{example}
    Испытания Бернулли, успех с вероятностью $p$,
    
    $P(\text{ОРО встречается бесконечное число раз}) = \ ?$.

    $A_n = $ случилось $\text{ОРО}$ на позициях $n, n + 1, n + 2$.

    Тогда $A_1, A_4, A_7, \ldots$ независимы. $P(A_j) = pqp = p^2 q > 0$.

    Лемма Бореля-Кантелли говорит: бесконечное кол-во $A_{3k + 1}$ случится, если $\sum_{k=1}^{\infty} {P(A_{3k + 1})} = +\infty \implies P(\text{ОРО встречается бесконечное число раз}) = 1$. 
\end{example}

\Subsection{Случайные величины}

\begin{definition}
    $(\Omega, \mathcal{F}, P)$ - вероятностное пространство.

    $\xi: \Omega \to \mathbb{R}$ - случайная величина, если 
    это измеримая функция.
\end{definition}

\begin{definition}
    Распределение случайное величины

    $P_{\xi}$ - вероятностная мера на борелевских подмножествах 
    $\mathbb{R}$

    $A$ -- борелевское мн-во, $P_{\xi}(A) = P(\omega \in \Omega \ : \ \xi(\omega) \in A)$
\end{definition}

\begin{definition}
    Случаный величины $\xi$ и $\eta$ одинаково распределены, если
    $P_{\xi} = P_{\eta}$
\end{definition}

\begin{remark}
    $P_{\xi}$ однозначно определяются своими значениями на ячейках.

    $P_{\xi} (a, b] = P_{\xi} (-\infty, b] - P_{\xi} (-\infty, a] = 
    P(\xi \leqslant b) - P(\xi \leqslant a)$
\end{remark}

\begin{definition}
    Функция распределения случайной величины

    $F_{\xi} (x) = P(\xi \leqslant x)$
\end{definition}

\begin{properties}
    \begin{enumerate}
        \item {
        Функция распределения однозначно определяет распределение
        случайной величины.

        \textit{Доказательство:} Если у двух случайных величин совпали, то у них одинаковые
        распределения
        }
        \item {
            $0 \leqslant F_{\xi}(x) \leqslant 1 \, \forall x \in \mathbb{R}$
        }

        \item {
            $\lim_{x \to -\infty} F_{\xi} (x) = 0$

            $\lim_{x \to +\infty} F_{\xi} (x) = 1$

            \textit{Доказательство:} берём $x_n \to -\infty. A_n = \{ \xi \leqslant x_n \} $
            Тогда $A_{n + 1} \subset A_n$. Тогда $\lim_{n \to \infty} P(A_n) = 
            P(\bigcap_{n = 1}^{\infty} A_n) = P(\emptyset) = 0$
        } 
        \item {
            $F_{\xi}$ монотонно возрастает
        }
        \item {
            Непрерывность справа: $\lim_{y \to x+} F_{\xi} (y) = F_{\xi} (x)$

            \textit{Доказательство:} берём $y_n$ убывающие и $y_n \to x$.
            Тогда $A_n = \{ \xi \leqslant y_n \}$. $A_{n + 1} \subset A_n$.
            А тогда $\lim P(A_n) = P(\bigcup_{n = 1}^{\infty} A_n) = P(\xi \leqslant x) = F_{\xi} (x)$.
            Но с другой стороны $\lim P(A_n) = \lim P(\xi \leqslant y_n) = \lim F_{\xi} (y_n)$
        }
        \item {
            $\lim_{y \to x-} F_{\xi} (y) P(\xi < x)$

            \textit{Доказательство:} берём $y_n$ возрастающие и
            $y_n \to x$. $B_n = \{ \xi \leqslant y_n \}$ и $B_{n} \subset B_{n + 1}$.
            $\lim P(B_n) = P(\bigcup B_n) = P(\xi < x)$. Но с другой стороны
            $\lim P(B_n) = \lim F_{\xi} (y_n)$
        }
        \item {
            $F_{\xi + a} (x) = F_{\xi} (x - a)$

            \textit{Доказательство:} $\{ \xi + a \leqslant x \} = 
            \{ \xi \leqslant x - a \}$
        }
        \item {
            $F_{c\xi} = F_{\xi} (\frac{x}{c})$

            \textit{Доказательство:} $\{ c\xi \leqslant x \} = 
            \{ \xi \leqslant \frac{x}{c} \}$
        }
    \end{enumerate}

    \begin{remark}
        Фукнция, обладающая свойствами 3, 4, 5 - это фукнция распределения
        некоторой случайной величины.

        \textit{Доказательство:} пусть $g$ - такая функция. Тогда $\nu_g (a, b] = g(b) - g(a) $.
        Случайная величина $\xi (x) = x$. Тогда $F_{\xi} = g$
    \end{remark}

\end{properties}

\begin{definition}
    Случайная величина имеет дискретное распределение, если её 
    множество значений не более чем счётное.

    \begin{remark}
        \begin{enumerate}
            \item { $\xi \to \{y_1, y_2, \ldots \}$

            Если $x \neq y_k$, то $P(\xi = x) = 0$, т.е. $P_{\xi}(\{ x \}) = 0$
            }

            \item { $P_{\xi} (A) = \sum_{k : y_k \in A} P(\xi = y_k)$. Тут счётное
            число слагаемых, поэтому сумма корректно определена.
    
            Распределение однозначно определяется набором вероятностей $P(\xi = y_k)$
            }
            \item {
                $F_{\xi} (x) = \sum_{k : y_k \leqslant x} P(\xi = y_k)$
            }
        \end{enumerate}
    \end{remark}
\end{definition}

\begin{definition}
    Случайная величина имеет непрерывное распределение, если 
    $P(\xi = x) = 0$

    \begin{remark}
        \begin{enumerate}
            \item {
                Это значит, что фукнция распределения непрерывна.
            }
            \item {
                Непрерывные распределения бывают не очень хорошими, например
                Канторова лестница.
            }
        \end{enumerate}
    \end{remark}
\end{definition}

\begin{definition}
    Случайная величина имеет абсолютно непрерывное распределение, если 
    существует $p_{\xi} (t) \geqslant 0$, измеримая, т.ч. $F_{\xi} (x) = 
    \int_{-\infty}^x p_{\xi} (t) \, dt$ ($p_{\xi}(t)$ -- плотность распределения).
\end{definition}

\begin{properties}
    \begin{enumerate}
        \item {
            $A \subset \mathbb{R}$ -- борелевское, то $P_{\xi} (A) = \int_{A} p_{\xi} (t) \, dt$

            \textit{Доказательство:} слева мера и справа мера. Нужно понять, почему
            они совпадают на ячейках. 

            $P_{\xi} (a, b] = F_{\xi} (b) - F_{\xi} (a) = \int_{a}^b p_{\xi} (t) \, dt$
        }
        \item {
            $\int_{-\infty}^{+\infty} p_{\xi} (t) \, dt = 1$
        }
        \item {
            $p_{\xi}$ определена однозначно с точностью до почти везде (из теории меры)
        }
        \item {
            $F_{\xi}$ почти везде диффиренцируема и $F_{\xi}' (x) = p_{\xi} (x)$

            \textit{Доказательство:} а его не будет
        }
    \end{enumerate}
\end{properties}

\begin{example}
    \textbf{Вероятностные распределения}

    \begin{enumerate}
        \item {
            Биномиальное распределение: $\xi \sim Binom(p, n), 0 < p < 1$

            $\xi : \Omega \to \{ 0, 1, \ldots n \}$. $P(\xi = k) \binom{n}{k} p^k (1 - p)^{n - k}$ 
        }
        \item {
            Распределение Пуассона: $\xi \sim Poisson(\lambda), \lambda > 0$.

            $\xi : \Omega \to \{ 0, 1, \ldots \}$. $P(\xi = k) = \frac{\lambda^k}{k!}e^{-\lambda}$
        }
        \item {
            Геометрическое распределение: $\xi \sim Geom(p), 0 < p < 1$.

            $\xi : \Omega \to \{ 1, 2, \ldots \}$. $P(\xi = k) = p(1 - p)^{k - 1}$.
        }
        \item {
            Дискретные равномерные распределения: $\xi \sim U(\ldots)$

            $\xi : \Omega \to \{ 1, 2, \ldots n \}$. $P(\xi = k) = \frac{1}{n}$
        }
        \item {
            Непрерывно равномерное распределение: $\xi \sim U([a, b])$

            $\xi : \Omega \to [a, b]$. $p_{\xi}(t) = \frac{1}{b - a} \cdot \mathds{1}_{[a, b]} (t)$
        }
        \item {
            Нормальное распределение: $\xi \sim \mathcal{N} (a, \sigma^2), a \in \mathbb{R}, \sigma > 0$

            $\xi : \Omega \to \mathbb{R}$. $p_{\xi}(t) = \frac{1}{\sqrt{2\pi} \cdot \sigma} e^{-\frac{(t - a)^2}{2\sigma^2}}$

            Стандартное нормальное распределение: $\mathcal{N} (0, 1)$
        }
        \item {
            Экспонециальное распределение: $\xi \sim Exp(\lambda), \lambda > 0$.

            $\xi : \Omega \to [0, +\infty]$. $p_{\xi}(t) = \begin{cases}
                \lambda e^{-\lambda t}, \text{ при } t \geqslant 0 \\
                0, \text{ в других точках}
            \end{cases}$
        }
    \end{enumerate}

    \begin{remark}
        \begin{enumerate}
            \item {
                $\Phi (x) = \frac{1}{\sqrt{2 \pi}} \int_{-\infty}^{x} e^{-\frac{t^2}{2}} \, dt$.

                На самом деле это функция распределения стандартной нормальной случайной величины.
            }
            \item {
                Если $\nu \sim \mathcal{N}(0, 1)$, то $\xi = \sigma \nu + a$. $\xi \sim \mathcal{N}(a, \sigma^2)$

                $F_{\xi} (x) = P(\sigma \nu + a \leqslant x) = P(\nu \leqslant \frac{x - a}{\sigma}) = \frac{1}{\sqrt{2 \pi}} 
                \int_{-\infty}^{\frac{x - a}{\sigma}} e^{-\frac{t^2}{2}} \, dt$

                Замена $t = \frac{s - a}{\sigma}$. Тогда $dt = \frac{ds}{\sigma}$

                Тогда: $\frac{1}{\sqrt{2 \pi}} 
                \int_{-\infty}^{\frac{x - a}{\sigma}} e^{-\frac{t^2}{2}} \, dt = \frac{1}{\sqrt{2\pi} \sigma}
                \int_{-\infty}^{x} e^{-\frac{(s - a)^2}{2\sigma^2}} \, ds$
            }
        \end{enumerate}
    
    \end{remark}
\end{example}

\Subsection{Совместное распределение}

\begin{definition}
    Совместное(многомерное) распределение.

    $\bar{\xi} = (\xi_1, \xi_2, \ldots, \xi_n) : \Omega \to \mathbb{R}^n$

    $P_{\bar{\xi}} (A) = P(\bar{\xi} \in A)$, где $A$ - борелевское подмножество $\mathbb{R}^n$ 

    \begin{remark}
        Совместное распределение однозначно определяет распределение случайной
        величины, но не наоборот

        \begin{example}
            $\xi, \eta : \Omega \to \{ 0, 1 \}$  с равными вероятностями.

            Если это были независимые подбрасывания: $(\xi, \eta) : \Omega \to
            \{ (0, 0), (0, 1), (1, 0), (1, 1) \}$  с равными вероятностями.

            Если $\xi = \eta$, то $(\xi, \eta) : \Omega \to \{ (0, 0), (1, 1) \}$.

        \end{example}
    \end{remark}
\end{definition}

\begin{definition}
    Случайные величины $\xi_1, \xi_2 \ldots \xi_n$ независимы, если для любых
    борелевских подмножеств $A_1, A_2 \ldots A_n \subset \mathbb{R}$, события
    $\{ \xi_1 \in A_1 \}, \ldots, \{ \xi_n \in A_n \}$ независимы

    \begin{remark}
        $P(\xi_1 \in A_1, \ldots, \xi_n \in A_n) = P(\xi_1 \in A_1) \cdot \ldots \cdot P(\xi_n \in A_n)$
    \end{remark}
\end{definition}

\begin{theorem}
    $\xi_1, \xi_2 \ldots \xi_n$ независимы $\Longleftrightarrow P_{\bar{\xi}} = P_{\xi_1} \times \ldots \times P_{\xi_n}$
\end{theorem}

\begin{proof}
    \begin{enumerate}
        \item $\Leftarrow$ очевидно. $P_{\bar{\xi}} (A_1 \times \ldots \times A_n) = P_{\xi_1} (A_1) \ldots P_{\xi_n}(A_n)$
        \item $\Rightarrow$. На множествах $A_1 \times \ldots \times A_n$ есть равенство + единственность продолжения.
    \end{enumerate}
\end{proof}
